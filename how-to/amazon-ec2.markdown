---
layout: howto
title:  "Amazon EC2"
date:   2014-08-26 9:42:00am
categories: [howto]
---

# Amazon EC2 Guide

Kaazing provides you the flexibility to deploy in whatever configuration you may have. There is a free developer edition to help you get started with no installation or configuration. Kaazing Gateway is available to download and install it on your local system, or behind your firewall. And you can even deploy your own instance to Amazon EC2. This guide will get you setup on Amazon EC2.

## Prerequisites

While we have tried to assume nearly no experience with Amazon Web Services (AWS) throughout this guide, an Amazon account is required. This can be the one you use to shop at home, an account related to your employer, or one you create specifically for this guide.

There are points during this guide that requires using the command-line interface on your system. The commands will be explained, but some prior experience will assist you in completing these tasks in a confident manner.

Finally, while I assume no experience with WebSocket, readers of this tutorial should feel comfortable with the web standards stack. This includes not only HTML and CSS, but also JavaScript. No framework dependency is used in this tutorial.

## Amazon Web Services Marketplace

[AWS Marketplace][1], not to be confused with Amazon Marketplace, provides all fashion of pre-built server configurations for you to use. This means you do not have to be an expert in configuring EC2 instances, and it also means that you do not have to be an expert in managing the software you want to run. For mere cents on the dollar, and with a few clicks of your mouse, you can explore an almost exhaustive world of server software. And in the end, if you do not like what you have found, simply terminate the instance, and move on, no worse for the wear.

>
If you are familiar with managing Amazon Web Services (AWS) infrastructure, have a key pair that you prefer to use, and understand managing security groups, then you can jump to the section entitled "Creating an Instance".

### Generating a Key Pair

When it comes to managing Amazon Web Services (AWS) resources, especially Amazon Marketplace instances, a "key pair" is probably the single most important step to get right. A key pair is a file that will be generated by Amazon, and that you will download to your system. It is this key that effectively replaces password-based access to AWS resources. It authenticates you against the resources you create in the AWS cloud. You will want to back it up and keep it safe. Without your key pair, you can no longer access your instances.

Sound serious enough? Good, let us move on to creating this important file.

AWS resources are managed through the [AWS Management Console](https://console.aws.amazon.com/ec2). You will need to log into your account at this point to access the Management Console specific to any resources you create, or have created in the past. If you are using the link above, you will be taken directly to the EC2 Dashboard. If you have not used the above link, you will need to navigate to the EC2 dashboard first.

On the left side of the EC2 Dashboard is a list of areas that you can choose to administer. Find the grouping labeled "Network & Security" and then click on the link for "Key Pairs" under that heading. This will take you to a page with a single big, blue, button labeled "Create Key Pair". When you click on the button labeled "Create Key Pair" you will be presented with a simple dialog to name this key pair. Name this key pair "kaazing-key-pair" so the resources it can be used with is clear for future reference.

Once you have typed in a name for this key pair, click the button labeled "Create". The dialog will disappear, and the download of a file with the extension "pem" or "cer" will begin. This is your key pair. Back it up now. You will be using this key pair later, so place it in a location on your machine that you can easily access later. I keep my key pairs in the user home directory on my machine. This makes for easy access from the command line when needed.

### Creating a Security Group

Amazon Web Services (AWS) tends to take security pretty seriously, which is great. It does however mean that we need to do a little more leg work before we can go spinning up instances ad hoc. The key pair that we just created is one example of that. Another example is "Security Groups". In the AWS vocabulary, a "Security Group" defines a firewall that controls traffic going into your new instance.

To setup a security group for this instance, head back to the [AWS Management Console](https://console.aws.amazon.com/ec2).  on the left side of the page, you will find a grouping of items labeled "Network & Security".  This is the same heading where you found the "Key Pairs" menu item earlier.  This time click on the link labeled "Security Groups".  Depending on what type of work you have done with AWS in the past, you may have some security groups available, or none at all.

![Create an AWS Security Group](http://static.kevinhoyt.com/devrel/images/image11.png)
![Edit the Security Group Details](http://static.kevinhoyt.com/devrel/images/image03.png)

Let us create a security group for this tutorial by clicking on the blue button labeled "Create Security Group". You will be presented with a dialog to complete.  For "Security group name" enter "kaazing-security-group". Prefixing these entries with "kaazing" will help us to associate resources as our own personal cloud grows. Enter a "Description" that makes sense for you, and leave the "VPC" field set to "No VPC".

We will want two (2) security group rules for our Kaazing WebSocket Gateway instance. Click the "Add Rule" button to insert a new rule. In the "Type" column, select the "SSH" option. Secure Shell (SSH) is how we will access the operating system (OS) of our instance in the future. Under the "Source" column, make sure that "Anywhere" is selected. This will allow you to access the OS of your instance from any IP address. If you know what IP address you will be using to administer your instance, then you can alternatively provide those details.

The "Port Range" value of 22, the SSH default port, will be populated for you. You do not need to change this setting.

Kaazing WebSocket Gateway software will start when you start the instance for the first time. It will listen on ports 8000 and 8001 for incoming traffic. We need to tell the security group that we want these ports to be open as well. Click on the button labeled "Add Rule" again to insert another row. For "Type" leave "Custom TCP Rule". For "Port Range" enter the value "8000-8001". And again, make sure that the "Source" column is set to "Anywhere". This time that "Anywhere" allows us to access the instance from any web browser.

>
If in the future you want to run a web server or other software on this instance, you can modify this security group from the AWS Management Console.

### Creating an Instance

If you head on over to the [AWS Marketplace](https://aws.amazon.com/marketplace) web site, you will find a search bar at the top of the page. In this case, we want to get started with WebSocket to enable our real-time web applications, so we will enter "Kaazing" as the search term, and click the "Go" button. You will get only one search result labeled "Kaazing WebSocket Gateway - JMS Edition". JMS stands for Java Message Service. At a high level, this means that if you have a technology in your infrastructure that can communicate with JMS (and many do), then you can easily extend Kaazing WebSocket Gateway to communicate with that other software. For the purposes of getting started however, this is an implementation detail that we can come back to later.

![The AWS Marketplace](http://static.kevinhoyt.com/devrel/images/image02.png)
![Kaazing Gateway on AWS Marketplace](http://static.kevinhoyt.com/devrel/images/image00.png)

If you click on the orange, rectangular Kaazing logo in that single search result, you will be taken to a page that gives you all the details of the AWS Marketplace instance. You can see that it will run on Ubuntu 12.04 using a 64-bit Amazon Machine Image (AMI). You can also see pricing for both the software and the EC2 instance. A "Standard Micro" instance will be more than adequate to get going, will cost nothing for Kaazing WebSocket Gateway software, and a mere \$0.20 per hour for the EC2 instance - or potentially \$0.00 if you qualify for the AWS Free Tier.

![Kaazing Gateway instance details](http://static.kevinhoyt.com/devrel/images/image07.png)
![Kaazing Gateway pre-launch](http://static.kevinhoyt.com/devrel/images/image10.png)

Clicking on the orange button labeled "Continue" will take you to a page that lets you fine tune your options before launching the actual instance. The default EC2 Instance Type is "Standard Large". If you are just getting started with WebSocket and simply want to explore what Kaazing WebSocket Gateway has to offer, then you might select a "Standard Micro" instance. At the time of this writing a Standard Micro instance will run \$0.02 per hour, or about \$14.40 per month. Other cloud-based solutions with WebSocket built-in will cost more and introduce artificial limitations.

Earlier in this tutorial we created a "Security Group" that defines a firewall and controls traffic going into your new instance. We named that security group "kaazing-security-group" and opened the appropriate ports needed to use Kaazing WebSocket Gateway. Scroll down the configuration page, and make sure that the security group you created earlier is the one selected from the available options. Once you have selected the option, you will see the description and port ranges listed for verification.

The last setting, and perhaps the most important, is the "Key Pair" section of the configuration page.  Rather than deal in passwords, AWS ties EC2 instances to "Key Pairs" to ensure that nobody else can access your software. We created a key pair earlier in this tutorial. Scroll down to the "Key Pair" section of the configuration, and expand it if necessary. Select the key pair you created earlier from the provided options.

>
I am assuming that you are following the naming instructions used in this tutorial. You can certainly use a different key pair and/or security group if you are familiar with managing AWS infrastructure. Please make sure the security group you use has a rule for the "8000-8001" range.

Now we are ready to get this party started! Click on the orange button labeled "Launch with 1-Click" to start your instance. You will be presented with a message that gives you some usage instructions, and software installation details. If you feel comfortable with the AWS Management Console, then you can close this dialog and head back to the EC2 Dashboard. Alternatively, you can click the link labeled "AWS Management Console". Starting the instance for the first time can take a few minutes. Go grab yourself a congratulatory coffee!

### Accessing Your Instance

How was that coffee? All good? Great, let us continue by accessing our very own Kaazing WebSocket Gateway instance. Once your shiny new instance is started, the Kaazing WebSocket Gateway software is also started. There are even demonstration examples included for you to get familiar with using WebSocket. There is just one problem at this point - we do not know the URL to use to access our Kaazing WebSocket Gateway instance.

To get this information head over the [AWS Management Console](https://console.aws.amazon.com/ec2) once again. In the center section of the page, you will see a heading titled "Resources". Under this heading you will find various pieces of information about your EC2 instance(s). Click on the first piece of information labeled "Running Instances". The number in front of that label may differ depending on your AWS usage prior to starting this tutorial.

![Ready to launch your Kaazing Gateway instance.](http://static.kevinhoyt.com/devrel/images/image01.png)
![Running instance listing](http://static.kevinhoyt.com/devrel/images/image09.png)

If you have used EC2 (or related) AWS features before, then you may have a list of instances presented to you. There will be no name associated with this newly created instance. You can move your mouse over the empty name field, and a pencil icon will appear. You can click on that pencil to edit the name of your newly created Kaazing WebSocket Gateway instance. Let us name it "kaazing-gateway".

Once you have named the instance, the row should automatically be selected for you. If it is not, select the row for the "kaazing-gateway" instance. In the bottom half of the page, you will get a variety of pieces of information about the instance. For our purposes at this point, we simply want the value for the field labeled "Public DNS". This usually starts with "ec2-".

Copy the "Public DNS" value, and paste it into the address bar in your browser. Append the value "8001" to the URL. This is one of the ports we opened earlier when we configured the security group. This is also the port where the provided examples can be located. Hit "Enter" on your keyboard to load the designated page. Congratulations, you are now running your own real-time cloud!

## WebSocket in Action

Do not believe me that you are up and running? Do you see that first big blue box labeled "Demos"? Let us check things out by clicking there (it will turn orange when your mouse rolls over it). This will present you with a list of demonstrations to check out. The "JavaScript JMS Demo" is great if you are looking for more specific compatibility with JMS. For now though, click on the link below that labeled "JavaScript Stock Demo".

![Kaazing Gateway demonstrations on your new instance.](http://static.kevinhoyt.com/devrel/images/image05.png)
![Simulated stock market data feed.](http://static.kevinhoyt.com/devrel/images/image08.png)

Once the demonstration has loaded, you will find three (3) fields to populate. The first one is location, and is populated for you with the URL for your Kaazing WebSocket Gateway instance. Note the trailing "jms" on the URL. This is a specific endpoint configured on the server itself. We will take a look at this in the next installment of this tutorial.

The "User Name" and "Password" fields can be left blank for the purposes of seeing the demonstration in action. Click the button labeled "Connect" and the area below the orange line should start populating with various companies and pretend stock data. You will see the data change value and color rapidly - far more rapidly than could be accomplished via a request/response approach. That is the beauty of WebSocket!

When the "Connect" button was clicked, the browser opened a WebSocket connection back to the server. It then has left that connection open. It is fully bi-directional at all times, and blazing fast. Meanwhile, a service on the server is generating the random stock values and sending them to the client. The client receives the values in an event-driven manner, and updates the DOM using JavaScript.

>
This will even work on your tablet or smartphone. Even old ones that do not support WebSocket. That is the awesomeness that is Kaazing WebSocket Gateway.

## Summary

Running your own real-time cloud from the AWS Marketplace may seem intimidating at first. By understanding the terms used, and what they do, we can quickly start up a new instance of Kaazing WebSocket Gateway, and access the provided demonstrations. From here you may want to build your own WebSocket example, and further configure your instance. You can find out more information about doing exactly that in our other guides.

[1]: https://aws.amazon.com/marketplace
